<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameSquad - Top Up Game</title>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@500;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
    /* --- RESET & VARIABLES (ASLI) --- */
    :root {
        --bg-dark: #4618AC;
        --card-bg: rgba(122, 89, 255, .15);
        --item-bg: #101935;
        --text-white: #ffffff;
        --text-grey: #a0aec0;
        --accent-blue: #3b82f6;
        --accent-orange: #fad318;
        --danger-red: #ff4757;
        --success-green: #10b981;

        --font-title: 'metropolis', sans-serif;
        --font-body: 'metropolis', sans-serif
    }

    /* --- METROPOLIS FONT FACE (ASLI) --- */
    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-Thin.otf') format('opentype');
        font-weight: 100;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-ExtraLight.otf') format('opentype');
        font-weight: 200;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-ExtraLightItalic.otf') format('opentype');
        font-weight: 200;
        font-style: italic;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-Light.otf') format('opentype');
        font-weight: 300;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-LightItalic.otf') format('opentype');
        font-weight: 300;
        font-style: italic;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-Regular.otf') format('opentype');
        font-weight: 400;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-RegularItalic.otf') format('opentype');
        font-weight: 400;
        font-style: italic;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-Medium.otf') format('opentype');
        font-weight: 500;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-MediumItalic.otf') format('opentype');
        font-weight: 500;
        font-style: italic;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-SemiBold.otf') format('opentype');
        font-weight: 600;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-SemiBoldItalic.otf') format('opentype');
        font-weight: 600;
        font-style: italic;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-Bold.otf') format('opentype');
        font-weight: 700;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-BoldItalic.otf') format('opentype');
        font-weight: 700;
        font-style: italic;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-ExtraBold.otf') format('opentype');
        font-weight: 800;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-ExtraBoldItalic.otf') format('opentype');
        font-weight: 800;
        font-style: italic;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-Black.otf') format('opentype');
        font-weight: 900;
        font-style: normal;
    }

    @font-face {
        font-family: 'Metropolis';
        src: url('Metropolis-BlackItalic.otf') format('opentype');
        font-weight: 900;
        font-style: italic;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        outline: none;
        -webkit-tap-highlight-color: transparent;
    }

    body {
        background-color: var(--bg-dark);
        color: var(--text-white);
        font-family: 'metropolis';
        max-width: 480px;
        margin: 0 auto;
        border-left: 1px solid #1c2e4a;
        border-right: 1px solid #1c2e4a;
        min-height: 100vh;
        padding-bottom: 3rem;
        position: relative;
        scroll-behavior: smooth;
    }

    /* --- HEADER / NAVBAR --- */
    header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 13px;
        background-color: var(--bg-dark);
        position: sticky;
        top: 0;
        z-index: 100;
        border-bottom: 0px solid var(--card-bg);
    }

    .logo {
        display: flex;
        flex-direction: column;
        align-items: center;
        font-family: var(--font-title);
        font-weight: 700;
        line-height: 1;
    }

    .logo i {
        font-size: 18px;
        color: var(--text-white);
    }

    .logo-link {
        text-decoration: none;
        color: inherit;
    }

    .logo span:first-child {
        font-size: 18px;
        letter-spacing: 1px;
    }

    .logo span:last-child {
        font-size: 8px;
        color: var(--text-grey);
    }

    .search-container {
        flex-grow: 1;
        margin: 0 10px;
        position: relative;
    }

    .search-container input {
        width: 100%;
        padding: 8px 35px 8px 15px;
        border-radius: 6px;
        border: none;
        background-color: white;
        font-family: var(--font-body);
    }

    .search-icon {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        color: #666;
    }

    .btn-masuk {
        background-color: #2b4c80;
        color: white;
        border: 1px solid #4a6fa5;
        padding: 6px 15px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        margin-right: 10px;
    }

    .menu-icon {
        font-size: 24px;
        color: white;
        cursor: pointer;
        line-height: 1;
    }

    /* --- QUICK TAGS --- */
    .quick-tags {
        display: flex;
        gap: 8px;
        padding: 0px;
        margin-bottom: 20px;
        padding-top: 10px;
        justify-content: flex-start;
        overflow-x: auto;
        margin-top: -15px;
        -webkit-overflow-scrolling: touch;
    }

    .quick-tags::-webkit-scrollbar {
        display: none;
    }

    .tag {
        background: rgba(0, 0, 0, 0.2);
        color: #fff;
        border: 1px solid rgba(0, 0, 0, 0.1);
        padding: 4px 12px;
        padding-top: 5px;
        border-radius: 10px;
        font-size: 13px;
        font-weight: 400;
        text-decoration: none;
        white-space: nowrap;
        margin-bottom: 10px;
    }

    /* --- HERO BANNER --- */
    .hero-section {
        padding: 0 15px;
        padding-top: 12px;
        margin-bottom: 25px;
    }

    .hero-card {
        background: linear-gradient(90deg, #5e1194 0%, #a419b0 100%);
        border-radius: 7px;
        overflow: hidden;
        position: relative;
        height: 140px;
        display: flex;
        align-items: center;
    }

    .hero-bg {
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0.3;
        mix-blend-mode: overlay;
    }

    .hero-content {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        z-index: 2;
        max-width: 80%;
    }

    .hero-content h3 {
        font-family: var(--font-title);
        font-size: 20px;
        font-weight: 800;
        text-transform: uppercase;
        margin-bottom: 5px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    .hero-content p {
        font-size: 11px;
        margin-bottom: 10px;
        font-weight: 600;
        color: #f1f1f1;
    }

    /* --- BREADCRUMB --- */
    .breadcrumb-container {
        padding: 15px 15px 5px 15px;
        font-size: 12px;
        color: var(--text-grey);
        font-family: var(--font-body);
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .breadcrumb-link {
        text-decoration: none;
        color: var(--text-grey);
        font-weight: 500;
        transition: color 0.2s;
        font-size: 13px;
    }

    .breadcrumb-link:hover {
        color: var(--accent-orange);
        text-decoration: underline;
    }

    .breadcrumb-separator {
        font-size: 10px;
        color: #4a5568;
    }

    .breadcrumb-active {
        color: var(--text-white);
        font-weight: 600;
        font-size: 13px;
    }

    /* --- GENERAL CARD STYLES (ASLI) --- */
    .order-container {
        padding: 0 15px;
    }

    .game-title-header {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
    }

    .game-icon {
        width: 50px;
        height: 50px;
        margin-top: 0px;
        border-radius: 3px;
        margin-right: 12px;
        object-fit: contain;
        background: white;
        padding: 5px;
        border: 2px solid transparent;
        box-shadow: 0 0 7px rgba(0, 0, 0, 0.5);
    }

    .game-info h2 {
        font-size: 18px;
        font-weight: 700;
        line-height: 1.2;
        margin-bottom: 3px;
    }

    .game-info span {
        font-size: 13px;
        color: var(--text-grey);
    }

    .game-sub-info {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 13px;
        color: var(--text-grey);
    }

    .link-tutorial {
        color: var(--text-grey);
        text-decoration: none;
        transition: color 0.2s;
        cursor: pointer;
    }

    .link-tutorial:hover {
        color: var(--accent-orange);
        text-decoration: underline;
    }

    .divider {
        color: #4a5568;
    }

    .blue-card {
        background-color: var(--bg-dark);
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
        border: 0px solid transparent;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
        position: relative;
        z-index: 1;
    }

    .blue-card-pulsa {
        background-color: var(--bg-dark);
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
        border: 0px solid transparent;
        position: relative;
        z-index: 1;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
    }

    .blue-card-co {
        background-color: var(--bg-dark);
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
        border: 0px solid transparent;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
        position: relative;
        z-index: 1;
    }

    /* --- CARD HISTORY STYLE --- */
    .card-history {
        background-color: #0c0d1933;
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 20px;
        margin-top: 4rem;
        border: 1px dashed #78818d;
    }

    .empty-history {
        text-align: center;
        font-size: 12px;
        color: var(--text-grey);
        padding: 10px;
        background: var(--bg-dark);
        padding: 20px;
        border-radius: 5px;
    }

    .card-history .step-header {
        margin-bottom: 10px;
    }

    .history-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .history-item {
        background: var(--bg-dark);
        border: 0px solid #2d3748;
        border-radius: 8px;
        padding: 10px;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .history-item:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: var(--accent-orange);
    }

    .h-left {
        display: flex;
        flex-direction: column;
    }

    .h-date {
        font-size: 10px;
        color: var(--text-grey);
        margin-bottom: 2px;
    }

    .h-product {
        font-size: 13px;
        font-weight: 600;
        color: white;
    }

    .h-right {
        text-align: right;
    }

    .h-status {
        font-size: 10px;
        background: var(--success-green);
        color: #000;
        padding: 2px 6px;
        border-radius: 4px;
        font-weight: 700;
        margin-bottom: 2px;
        display: inline-block;
    }

    .h-price {
        font-size: 12px;
        font-weight: 700;
        color: var(--accent-orange);
    }

    .step-header {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
    }

    .step-num {
        background-color: var(--accent-blue);
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        margin-right: 10px;
    }

    .step-title {
        font-size: 14px;
        font-weight: 600;
    }

    /* --- FORM STYLES (ASLI) --- */
    .form-input-group {
        position: relative;
        margin-bottom: 10px;
    }

    .form-input {
        width: 100%;
        padding: 12px 12px 12px 45px;
        background-color: rgba(0, 0, 0, .2);
        border: 0px solid transparent;
        border-radius: 13px;
        font-family: var(--font-body);
        font-size: 14px;
        font-weight: 600;
        color: #333;
        transition: all 0.3s ease;
        box-shadow: inset 0 1px 3px #1f0a4d;
    }

    .input-icon {
        position: absolute;
        left: 14px;
        top: 50%;
        transform: translateY(-50%);
        color: #666;
        font-size: 18px;
    }

    .input-icon-kanan {
        position: absolute;
        right: 14px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-grey);
        font-size: 18px;
        cursor: pointer;
        pointer-events: auto !important;
        z-index: 10;
        transition: transform 0.2s;
    }

    .input-icon-kanan:active {
        transform: translateY(-50%) scale(0.9);
    }

    /* --- ADDED FOR GAME ID LAYOUT (Minimal additions) --- */
    .input-row-game {
        display: flex;
        gap: 10px;
        width: 100%;
    }

    .input-col-game {
        display: flex;
        flex-direction: column;
    }

    .input-col-game.userid {
        flex: 2;
    }

    .input-col-game.zoneid {
        flex: 1;
    }

    .input-col-game.hidden {
        display: none;
    }

    .input-label-game {
        font-size: 11px;
        color: var(--text-grey);
        margin-bottom: 6px;
        margin-left: 5px;
        font-weight: 600;
    }

    /* --- BOTTOM SHEET MODAL STYLE (ASLI) --- */
    .sheet-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.4);
        z-index: 2000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }

    .sheet-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .bottom-sheet {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: var(--bg-dark);
        border-top-left-radius: 24px;
        border-top-right-radius: 24px;
        padding: 10px 20px 30px 20px;
        z-index: 2001;
        transform: translateY(100%);
        transition: transform 0.35s cubic-bezier(0.2, 0.8, 0.2, 1);
        box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.3);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        max-width: 480px;
        margin: 0 auto;
    }

    .bottom-sheet.active {
        transform: translateY(0);
    }

    .sheet-handle-bar {
        width: 40px;
        height: 4px;
        background-color: #fff;
        border-radius: 10px;
        margin: 8px auto 20px auto;
    }

    .sheet-header-title {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px dashed #2d3748;
    }

    .sheet-header-title i {
        font-size: 20px;
        color: var(--accent-orange);
    }

    .sheet-header-title h3 {
        font-size: 16px;
        font-weight: 700;
        color: white;
    }

    .guide-list {
        list-style: none;
        padding: 0;
    }

    .guide-item {
        display: flex;
        gap: 15px;
        margin-bottom: 15px;
        align-items: flex-start;
    }

    .guide-icon {
        min-width: 24px;
        height: 24px;
        background: #fad41844;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--accent-orange);
        font-size: 12px;
        font-weight: bold;
        margin-top: 2px;
    }

    .guide-text h4 {
        font-size: 13px;
        color: #f1f5f9;
        margin-bottom: 3px;
        font-weight: 600;
    }

    .guide-text p {
        font-size: 11px;
        color: #94a3b8;
        line-height: 1.4;
    }

    .btn-sheet-close {
        width: 100%;
        background: var(--accent-orange);
        color: var(--bg-dark);
        border: none;
        padding: 12px;
        border-radius: 0px;
        font-weight: 600;
        margin-top: 10px;
        cursor: pointer;
        font-family: var(--font-body);
    }

    .btn-sheet-close:active {
        transform: scale(0.98);
    }

    .form-input:focus {
        border-color: #6222cc;
    }

    /* --- PAYMENT SECTION (ASLI) --- */
    .payment-category {
        margin-bottom: 15px;
    }

    .payment-cat-title {
        font-size: 11px;
        text-transform: uppercase;
        color: var(--text-grey);
        margin-bottom: 8px;
        letter-spacing: 0.5px;
        font-weight: 700;
    }

    .payment-item {
        position: relative;
        overflow: visible !important;
        margin-top: 15px !important;
        background-color: #e2e8f0;
        border-radius: 13px;
        padding: 12px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 8px;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.2s;
    }

    .payment-item-qris {
        position: relative;
        overflow: visible !important;
        margin-top: 15px !important;
        background-color: #e2e8f0;
        border-radius: 13px;
        padding: 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 8px;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.2s;
    }

    .payment-item:hover {
        transform: translateY(-2px);
    }

    .payment-item.active {
        border-color: var(--accent-orange);
        background-color: #fff9ed;
    }

    .payment-item-qris.active {
        border-color: var(--accent-orange);
        background-color: #fff9ed;
    }

    .payment-item.recommended {
        background-color: #fffbf2;
        border: 1.5px solid var(--accent-orange);
        box-shadow: 0 4px 12px rgba(245, 158, 11, 0.15);
        position: relative;
        z-index: 5;
    }

    .badge-hot-line {
        position: absolute;
        top: -11px;
        right: 15px;
        background: linear-gradient(to bottom, #f59e0b, #d97706);
        color: #fff;
        font-size: 10px;
        font-weight: 700;
        text-transform: uppercase;
        padding: 3px 10px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        z-index: 10;
        letter-spacing: 0.5px;
        display: flex;
        align-items: center;
        gap: 4px;
    }

    .badge-hot-line i {
        font-size: 13px;
        display: inline-block;
        background-color: #ffffff;
        background-image:
            url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' preserveAspectRatio='none'%3E%3Cpath fill='%23ff4757' d='M0,100 C50,150 100,50 150,100 C200,150 250,50 300,100 V200 H0 Z' /%3E%3C/svg%3E"),
            url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' preserveAspectRatio='none'%3E%3Cpath fill='%23ffca28' d='M0,100 C50,150 100,50 150,100 C200,150 250,50 300,100 V200 H0 Z' /%3E%3C/svg%3E");
        background-position-x: 0%, -50%;
        background-repeat: repeat-x;
        background-size: 200% 200%;
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        animation: liquid-fill-dual 3s infinite linear, wave-flow-dual 2s infinite linear, pulse-smooth 1s infinite ease-in-out alternate;
    }

    @keyframes liquid-fill-dual {
        0% {
            background-position-y: 200%, 205%;
        }

        60% {
            background-position-y: 30%, 35%;
        }

        100% {
            background-position-y: 30%, 35%;
        }
    }

    @keyframes wave-flow-dual {
        0% {
            background-position-x: 0%, -50%;
        }

        100% {
            background-position-x: -200%, -250%;
        }
    }

    @keyframes pulse-smooth {
        0% {
            transform: scale(1);
        }

        100% {
            transform: scale(1.2);
        }
    }


    .pay-left {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .pay-logo {
        width: 50px;
        height: 25px;
        object-fit: contain;
        background: #f0f0f0;
        border-radius: 5px;
        padding: 2px;
    }

    .pay-name {
        font-size: 14px;
        font-weight: 600;
        color: #333;
    }

    .pay-price {
        font-size: 13px;
        font-weight: 700;
        color: #333;
        text-align: right;
        padding-top: 2px;
    }

    /* --- SUMMARY SECTION --- */
    .summary-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 9px;
        font-size: 13px;
        color: var(--text-white);
    }

    .summary-row.total {
        border-top: 1px dashed var(--text-grey);
        padding-top: 13px;
        margin-top: 10px;
        margin-bottom: -5px;
    }

    .summary-val {
        color: white;
        font-weight: 600;
    }

    .summary-val.highlight {
        color: var(--accent-orange);
        font-weight: 700;
        font-size: 16px;
    }

    /* --- BOTTOM STICKY CHECKOUT (ASLI) --- */
    .sticky-checkout {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: #1c2e4a;
        padding: 15px 20px;
        border-top-left-radius: 15px;
        border-top-right-radius: 15px;
        border-top: 1px solid #2d3748;
        display: flex;
        align-items: center;
        justify-content: space-between;
        z-index: 90;
        max-width: 480px;
        margin: 0 auto;
        display: none !important;
    }

    .checkout-price-info {
        display: flex;
        flex-direction: column;
    }

    .checkout-label {
        font-size: 10px;
        color: var(--text-grey);
    }

    .checkout-total {
        font-size: 18px;
        font-weight: 800;
        color: var(--accent-orange);
    }

    .btn-checkout {
        font-family: var(--font-body);
        background: linear-gradient(to bottom, #fad318, #fad318);
        color: #222;
        font-weight: 700;
        border: none;
        padding: 10px 20px;
        border-radius: 13px;
        font-size: 15px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        width: 100%;
        margin-top: 20px;
        transition: transform 0.2s;
    }

    .btn-checkout:active {
        transform: scale(0.98);
    }

    .btn-checkout i {
        font-size: 18px;
    }

    /* --- ERROR STATES --- */
    @keyframes shake {
        0%, 100% {
            transform: translateX(0);
        }
        10%, 30%, 50%, 70%, 90% {
            transform: translateX(-5px);
        }
        20%, 40%, 60%, 80% {
            transform: translateX(5px);
        }
    }

    .card-danger {
        border-color: var(--danger-red) !important;
        box-shadow: 0 0 15px rgba(255, 71, 87, 0.3);
        animation: shake 0.5s cubic-bezier(.36, .07, .19, .97) both;
    }

    .input-danger {
        border-color: var(--danger-red) !important;
        background-color: #fff0f0;
    }

    /* --- MODAL / POPUP SIMULATION --- */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(5px);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        padding: 20px;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
        display: flex;
        opacity: 1;
    }

    .modal-content {
        background: #fff;
        width: 100%;
        max-width: 400px;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        position: relative;
        transform: translateY(20px);
        transition: transform 0.3s ease;
    }

    .modal-overlay.active .modal-content {
        transform: translateY(0);
    }

    .sim-header {
        background: var(--bg-dark);
        padding: 15px;
        text-align: center;
        color: white;
    }

    .sim-body {
        padding: 20px;
        text-align: center;
        color: #333;
    }

    .bank-logo {
        width: 80px;
        margin: 0 auto 10px;
        object-fit: contain;
    }

    .qr-container {
        display: none;
        flex-direction: column;
        align-items: center;
        margin: 20px 0;
        background: white;
        padding: 15px;
        border-radius: 8px;
        border: 2px dashed var(--accent-blue);
    }

    .qr-container.active {
        display: flex;
    }

    .qr-image {
        width: 200px;
        height: 200px;
        object-fit: contain;
    }

    .va-number-container {
        display: block;
    }

    .va-number-container.hidden {
        display: none;
    }

    .va-number {
        font-family: monospace;
        font-size: 24px;
        font-weight: 700;
        color: var(--accent-blue);
        background: #f0f9ff;
        padding: 10px;
        border-radius: 8px;
        margin: 10px 0;
        letter-spacing: 2px;
        border: 1px dashed var(--accent-blue);
    }

    .sim-instruction {
        font-size: 13px;
        color: #666;
        margin-bottom: 20px;
        background: #f9fafb;
        padding: 10px;
        border-radius: 8px;
        text-align: left;
    }

    .sim-instruction li {
        margin-bottom: 5px;
        margin-left: 20px;
    }

    /* Success Invoice View */
    .invoice-view {
        display: none;
        flex-direction: column;
        align-items: center;
        padding: 30px 20px;
        text-align: center;
        animation: fadeIn 0.5s ease;
        background: white;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: scale(0.95);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    .success-icon-circle {
        width: 80px;
        height: 80px;
        background: #d1fae5;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
    }

    .success-icon-circle i {
        font-size: 40px;
        color: var(--success-green);
    }

    .inv-title {
        font-size: 20px;
        font-weight: 700;
        color: var(--bg-dark);
        margin-bottom: 5px;
    }

    .inv-subtitle {
        font-size: 13px;
        color: #666;
        margin-bottom: 25px;
    }

    .inv-details {
        width: 100%;
        background: #f8fafc;
        border-radius: 10px;
        padding: 15px;
        text-align: left;
        font-size: 14px;
        margin-bottom: 25px;
    }

    .inv-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        border-bottom: 1px dashed #e2e8f0;
        padding-bottom: 8px;
    }

    .inv-row:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
    }

    .inv-label {
        color: #64748b;
    }

    .inv-val {
        font-weight: 600;
        color: #334155;
    }

    .btn-close-modal {
        background: var(--bg-dark);
        color: white;
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: none;
        font-weight: 600;
        cursor: pointer;
        margin-bottom: 10px;
    }

    .btn-download {
        background: white;
        color: var(--bg-dark);
        border: 2px solid var(--bg-dark);
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    .floating-wa {
        position: fixed;
        bottom: 90px;
        right: 20px;
        background-color: #25d366;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        text-decoration: none;
        z-index: 99;
        display: none;
    }

    .floating-wa i {
        font-size: 28px;
        color: white;
    }

    /* --- STYLE TAMBAHAN KONFIRMASI SHEET --- */
    .confirm-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .confirm-header h3 {
        font-size: 16px;
        font-weight: 700;
        color: white;
    }

    .btn-close-x {
        background: none;
        border: none;
        color: var(--text-grey);
        font-size: 18px;
        cursor: pointer;
    }

    .timer-alert {
        background-color: #fff9ed;
        border: 1px solid #ffeebb;
        border-radius: 8px;
        padding: 10px;
        display: flex;
        gap: 10px;
        align-items: flex-start;
        margin-bottom: 20px;
    }

    .timer-alert i {
        color: #d97706;
        font-size: 16px;
        margin-top: 2px;
    }

    .timer-text {
        font-size: 11px;
        color: #92400e;
        line-height: 1.4;
    }

    .detail-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        font-size: 13px;
    }

    .label-detail {
        color: var(--text-grey);
    }

    .val-detail {
        color: white;
        font-weight: 600;
        text-align: right;
    }

    .val-detail img {
        height: 18px;
        vertical-align: middle;
        margin-left: 5px;
        background: white;
        padding: 2px;
        border-radius: 3px;
    }

    .dashed-divider {
        border-bottom: 1px dashed #4a5568;
        margin: 15px 0;
    }

    .security-bar {
        background-color: #ecfdf5;
        margin-left: -20px;
        margin-right: -20px;
        padding: 12px 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
        margin-top: 15px;
    }

    .sec-left {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .sec-text {
        font-size: 11px;
        color: #064e3b;
        font-weight: 600;
    }

    .sec-icon-shield {
        color: #10b981;
    }

    .sec-icon-warn {
        color: #f59e0b;
    }

    .status-badge-pending {
        background: #fffbeb;
        color: #b45309;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 10px;
        font-weight: 700;
        text-transform: uppercase;
    }

    /* --- PRODUCT GRID (ASLI) --- */
    .items-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }

    .item-card {
        background: rgba(0, 0, 0, 0.2);
        border: 0px solid #2d3748;
        border-radius: 8px;
        padding: 12px;
        transition: all 0.2s;
        display: flex;
        flex-direction: column;
        justify-content: center;
        min-height: 80px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 5px 7px rgba(0, 0, 0, 0.2);
        cursor: pointer;
    }

    .item-card::before {
        content: "";
        position: absolute;
        z-index: 1;
        left: 0px;
        bottom: 0px;
        top: 30px;
        right: 0px;
        border-bottom: 22px solid rgba(255, 255, 255, 0.08);
        border-left: 0px solid var(--accent-orange);
        border-bottom-left-radius: 6px;
        pointer-events: none;
        opacity: 1;
        transition: all 0.3s ease;
    }

    .item-card:hover {
        border-color: var(--accent-blue);
        background-color: #051b3b;
    }

    .item-card.active {
        border-color: var(--accent-orange);
        background-color: #1a2740;
        box-shadow: inset 0 0 0 1px var(--accent-orange);
    }

    .item-card.active::after {
        content: "\eb7b";
        font-family: remixicon;
        position: absolute;
        top: 0;
        right: 0;
        background: var(--accent-orange);
        color: #000;
        font-size: 12px;
        padding: 2px 6px;
        border-bottom-left-radius: 8px;
    }

    .item-name {
        font-size: 13px;
        font-weight: 700;
        text-transform: uppercase;
        margin-bottom: 19px;
        color: var(--text-white);
    }

    .item-price {
        font-size: 13px;
        font-weight: 600;
        color: #fff;
        background-color: rgba(0, 0, 0, 0.2);
        position: absolute;
        left: 0;
        bottom: 0px;
        width: auto;
        padding: 4px 11px;
        height: 23px;
        margin-bottom: 4px;
        border-top-right-radius: 0px;
        border-bottom-right-radius: 0px;
        z-index: 10;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding-top: 5px !important;
        padding-bottom: 2px !important;
        line-height: normal;
    }

    .wa-disclaimer {
        font-size: 10px;
        color: var(--text-grey);
        margin-top: -5px;
        margin-bottom: 10px;
        margin-left: 5px;
        /*font-style: italic;*/
        font-weight: 400;
    }
</style>
   
</head>

<body>
    <header>
        <a href="index.html" class="logo-link">
         <div class="logo">
            <i class="fa-solid fa-gamepad"></i>
            <span>HUPAYTOP</span>
         </div>
        </a>
        <div class="search-container">
            <input type="text" placeholder="Cari Game...">
            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        </div>
        <button class="btn-masuk" onclick="window.location.href='login.html'">Login</button>
        <i class="ri-menu-line menu-icon"></i>
    </header>

    <div class="breadcrumb-container">
        <a href="index.html" class="breadcrumb-link">Beranda</a>
        <i class="fa-solid fa-chevron-right breadcrumb-separator" style="font-size: 9px; color: white;"></i>
        <span class="breadcrumb-active" id="dynamic-breadcrumb">Mobile Legends</span>
    </div>

    <section class="hero-section">
        <div class="hero-card">
            <img src="https://images.unsplash.com/photo-1512428559087-560fa5ce7d71?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Banner" class="hero-bg">
            <div class="hero-content">
                <h3>TOP UP GAME</h3>
                <p>Harga Termurah, Proses Detik!</p>
            </div>
        </div>
    </section>

    <div class="order-container">
        <div class="game-title-header">
            <img src="" alt="Game Logo" class="game-icon" id="dynamic-logo">
            <div class="game-info">
                <h2 id="dynamic-title">Mobile Legends</h2>
                <div class="game-sub-info">
                    <span id="dynamic-subtitle">Moonton</span>
                    <span class="divider">/</span>
                    <a href="javascript:void(0)" class="link-tutorial" onclick="openTutorial()">Cara Pembelian <i class="ri-question-line"></i></a>
                </div>
            </div>
        </div>

        <nav class="quick-tags" id="provider-tags"></nav>

        <div class="blue-card-pulsa" id="form-identity-card">
            <div class="step-header">
                <div class="step-num">1</div>
                <div class="step-title" id="input-step-title">Masukkan Data Akun</div>
            </div>

            <!-- Input Row Game (User ID / Zone ID) -->
            <div class="input-row-game">
                <div class="input-col-game userid">
                    <div class="input-label-game" id="label-userid">User ID</div>
                    <div class="form-input-group">
                        <i class="fa-solid fa-user input-icon"></i>
                        <input type="tel" id="input-userid" class="form-input" placeholder="12345678">
                        <i class="fa-solid fa-circle-exclamation input-icon-kanan" onclick="openGuide()"></i>
                    </div>
                </div>

                <!-- Kolom Zone ID (Hanya muncul jika MLBB) -->
                <div class="input-col-game zoneid" id="wrapper-zoneid">
                    <div class="input-label-game" id="label-zoneid">Zone ID</div>
                    <div class="form-input-group">
                        <i class="fa-solid fa-hashtag input-icon"></i>
                        <input type="tel" id="input-zoneid" class="form-input" placeholder="(1234)">
                    </div>
                </div>
            </div>

            <p style="font-size: 10px; color: var(--text-grey); margin-top: 8px; margin-left: 5px;">*Pastikan ID yang dimasukkan benar untuk menghindari kehilangan item.</p>
        </div>

        <div class="blue-card">
            <div class="step-header">
                <div class="step-num">2</div>
                <div class="step-title">Pilih Nominal Diamond</div>
            </div>
            <div class="items-grid" id="products-container"></div>
        </div>

        <div class="blue-card" id="payment-section">
            <div class="step-header">
                <div class="step-num">3</div>
                <div class="step-title">Pilih Pembayaran</div>
            </div>

            <div class="payment-category">
                <div class="payment-cat-title">E-Wallet & QRIS</div>
                
                <div class="payment-item-qris" onclick="selectPayment(this, 'QRIS (All E-Wallet)', 0, 'qris')">
                    <div class="badge-hot-line"><i class="fa-solid fa-fire"></i> REKOMENDASI</div>
                    <div class="pay-left">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/QRIS_logo.svg/1200px-QRIS_logo.svg.png" class="pay-logo">
                        <div class="pay-name">
                            QRIS <br>
                            <span style="font-weight: normal; font-size: 11px; color: #666;">(Scan Semua E-Wallet)</span>
                        </div>
                    </div>
                    <div class="pay-right">
                        <div class="pay-price" data-fee="0">Rp -</div>
                    </div>
                </div>

                <div class="payment-item" onclick="selectPayment(this, 'DANA', 1000, 'dana')">
                    <div class="pay-left">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Logo_dana_blue.svg/1200px-Logo_dana_blue.svg.png" class="pay-logo">
                        <div class="pay-name">DANA</div>
                    </div>
                    <div class="pay-right">
                        <div class="pay-price" data-fee="1000">Rp -</div>
                    </div>
                </div>
            </div>

            <div class="payment-category">
                <div class="payment-cat-title">Virtual Account</div>
                
                <div class="payment-item" onclick="selectPayment(this, 'BCA Virtual Account', 2500, 'bca')">
                    <div class="pay-left">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/2560px-Bank_Central_Asia.svg.png" class="pay-logo">
                        <div class="pay-name">BCA VA</div>
                    </div>
                    <div class="pay-right">
                        <div class="pay-price" data-fee="2500">Rp -</div>
                    </div>
                </div>

                <div class="payment-item" onclick="selectPayment(this, 'Mandiri VA', 2500, 'mandiri')">
                    <div class="pay-left">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Bank_Mandiri_logo_2016.svg/1200px-Bank_Mandiri_logo_2016.svg.png" class="pay-logo">
                        <div class="pay-name">Mandiri VA</div>
                    </div>
                    <div class="pay-right">
                        <div class="pay-price" data-fee="2500">Rp -</div>
                    </div>
                </div>
            </div>

            <div class="payment-category">
                <div class="payment-cat-title">Minimarket</div>
                <div class="payment-item" onclick="selectPayment(this, 'Alfamart', 3500, 'alfamart')">
                    <div class="pay-left">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Alfamart_logo.svg/1200px-Alfamart_logo.svg.png" class="pay-logo">
                        <div class="pay-name">Alfamart</div>
                    </div>
                    <div class="pay-right">
                        <div class="pay-price" data-fee="3500">Rp -</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="blue-card-co">
            <div class="step-header">
                <div class="step-num">4</div>
                <div class="step-title">Ringkasan Pesanan</div>
            </div>
            
            <div class="summary-row">
                <span>Produk Game</span>
                <span class="summary-val" id="summary-product">-</span>
            </div>

            <div class="summary-row">
                <span id="summary-id-label">ID Akun</span> 
                <span class="summary-val" id="summary-id-val">-</span>
            </div>

            <div class="summary-row">
                <span>Item Diamond</span>
                <span class="summary-val" id="summary-item">-</span>
            </div>

            <div class="summary-row">
                <span>Harga Produk</span>
                <span class="summary-val" id="summary-price">Rp 0</span>
            </div>

            <div class="summary-row">
                <span>Biaya Admin</span>
                <span class="summary-val" id="summary-fee">Rp 0</span>
            </div>
            
            <div class="form-input-group" style="margin-top: 15px;">
                <i class="ri-whatsapp-line input-icon" style="color: #25d366;"></i>
                <input type="tel" id="input-wa" class="form-input" placeholder="Nomor WhatsApp (08xx)">
            </div>
            <p class="wa-disclaimer">*kami kirim untuk bukti pembelian (opsional)</p>

            <div class="summary-row total">
                <span>Total Bayar</span>
                <span class="summary-val highlight" id="summary-total">Rp 0</span>
            </div>

            <button class="btn-checkout" onclick="processOrder()">
                <i class="ri-shield-check-fill"></i> Konfirmasi Pesanan
            </button>
        </div>

        <div class="card-history">
            <div class="step-header">
                <div class="step-title">Riwayat Transaksi</div>
            </div>
            <div class="history-list" id="history-list-container">
                <div class="empty-history">Belum ada transaksi.</div>
            </div>
        </div>

    </div>

    <a href="#" class="floating-wa">
        <i class="ri-whatsapp-line"></i>
    </a>

    <!-- MODAL SIMULATION & INVOICE -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-content">
            <!-- STATE 1: SIMULASI TRANSFER -->
            <div id="sim-view">
                <div class="sim-header">
                    <h3 style="margin:0;">Menunggu Pembayaran</h3>
                </div>
                <div class="sim-body">
                    <p style="font-size:12px; color:#666; margin-bottom:10px;">Selesaikan pembayaran sebelum:</p>
                    <div style="font-weight:bold; color:var(--danger-red); font-size:14px; margin-bottom:15px;" id="timer-countdown">23:59:59</div>
                    
                    <img src="" id="sim-bank-logo" class="bank-logo" alt="Payment Logo">
                    <p id="sim-payment-name" style="font-weight:700; font-size:16px; margin-bottom:5px;">Metode Pembayaran</p>
                    
                    <div class="qr-container" id="sim-qr-container">
                        <img src="" id="sim-qr-image" class="qr-image" alt="QR Code">
                        <p style="font-size:12px; margin-top:10px; color:#666;">Scan QR Code di atas menggunakan aplikasi E-Wallet Anda.</p>
                    </div>

                    <div class="va-number-container" id="sim-va-container">
                        <div class="va-number" id="sim-va-number">8800 1234 5678</div>
                        <div class="sim-instruction">
                            <strong>Nominal: <span id="sim-total" style="color:var(--accent-blue);">Rp 0</span></strong>
                            <ul style="margin-top:10px; padding-left:15px; font-size:12px; color:#555;">
                                <li>Login ke Mobile Banking / ATM Anda.</li>
                                <li>Pilih menu Transfer ke Virtual Account.</li>
                                <li>Masukkan nomor <span id="sim-bank-name">Bank</span> di atas.</li>
                                <li>Pastikan nominal sesuai.</li>
                            </ul>
                        </div>
                    </div>

                    <button class="btn-checkout" style="width:100%; justify-content:center; background:#334155;" onclick="checkPaymentSim()">
                        Cek Status Pembayaran
                    </button>
                </div>
            </div>

            <!-- STATE 2: INVOICE SUKSES -->
            <div id="invoice-view" class="invoice-view">
                <div class="success-icon-circle">
                    <i class="ri-check-line"></i>
                </div>
                <h2 class="inv-title">Pembayaran Sukses!</h2>
                <p class="inv-subtitle">Diamond sedang dikirim ke akun Anda.</p>
                
                <div class="inv-details">
                    <div class="inv-row">
                        <span class="inv-label">No. Pesanan</span>
                        <span class="inv-val">TRX-<span id="inv-trx-id">889021</span></span>
                    </div>
                    <div class="inv-row">
                        <span class="inv-label">ID Akun</span>
                        <span class="inv-val" id="inv-phone">0838xxxx</span>
                    </div>
                    <div class="inv-row">
                        <span class="inv-label">Produk</span>
                        <span class="inv-val" id="inv-product">MLBB 86 DM</span>
                    </div>
                    <div class="inv-row">
                        <span class="inv-label">Metode Bayar</span>
                        <span class="inv-val" id="inv-method">BCA VA</span>
                    </div>
                    <div class="inv-row">
                        <span class="inv-label">Total Bayar</span>
                        <span class="inv-val" style="color:var(--accent-blue);" id="inv-total">Rp 15.000</span>
                    </div>
                    <div class="inv-row">
                        <span class="inv-label">Waktu</span>
                        <span class="inv-val" id="inv-time">12:30</span>
                    </div>
                </div>

                <button class="btn-download" onclick="downloadInvoice()">
                    <i class="ri-download-line"></i> Download Invoice
                </button>
                <button class="btn-close-modal" onclick="closeModal()">Tutup</button>
            </div>
        </div>
    </div>

    <!-- BOTTOM SHEETS -->
    <div class="sheet-overlay" id="sheetOverlay" onclick="closeAllSheets()"></div>

    <div class="bottom-sheet" id="guideSheet">
        <div class="sheet-handle-bar"></div>
        
        <div class="sheet-header-title">
            <i class="fa-solid fa-book-open"></i>
            <h3>Panduan Pengisian ID</h3>
        </div>

        <ul class="guide-list">
            <li class="guide-item">
                <div class="guide-icon">1</div>
                <div class="guide-text">
                    <h4>Cek ID Game</h4>
                    <p>Buka menu profil di dalam game untuk melihat User ID Anda.</p>
                </div>
            </li>
            <li class="guide-item" id="guide-step-zone">
                <div class="guide-icon">2</div>
                <div class="guide-text">
                    <h4>Zone ID (Jika Ada)</h4>
                    <p>Untuk Mobile Legends, gabungkan User ID dan Zone ID (Contoh: 12345678 (1234)).</p>
                </div>
            </li>
            <li class="guide-item">
                <div class="guide-icon">3</div>
                <div class="guide-text">
                    <h4>Kesalahan Input</h4>
                    <p>Kesalahan memasukkan ID sepenuhnya tanggung jawab pembeli.</p>
                </div>
            </li>
        </ul>

        <button class="btn-sheet-close" onclick="closeAllSheets()">Saya Mengerti</button>
    </div>

    <div class="bottom-sheet" id="tutorialSheet">
        <div class="sheet-handle-bar"></div>
        
        <div class="sheet-header-title">
            <i class="ri-question-line" style="color: var(--accent-orange);"></i>
            <h3>Cara Pembelian</h3>
        </div>

        <ul class="guide-list">
            <li class="guide-item">
                <div class="guide-icon">1</div>
                <div class="guide-text">
                    <h4>Masukkan Data Akun</h4>
                    <p>Ketik User ID atau User ID + Zone ID (untuk MLBB).</p>
                </div>
            </li>

            <li class="guide-item">
                <div class="guide-icon">2</div>
                <div class="guide-text">
                    <h4>Pilih Nominal</h4>
                    <p>Pilih jumlah Diamond yang ingin dibeli.</p>
                </div>
            </li>

            <li class="guide-item">
                <div class="guide-icon">3</div>
                <div class="guide-text">
                    <h4>Metode Pembayaran</h4>
                    <p>Pilih metode pembayaran (E-Wallet, QRIS, atau Transfer Bank).</p>
                </div>
            </li>

            <li class="guide-item">
                <div class="guide-icon">4</div>
                <div class="guide-text">
                    <h4>Bayar</h4>
                    <p>Lakukan pembayaran, item akan masuk otomatis dalam hitungan detik.</p>
                </div>
            </li>
        </ul>

        <button class="btn-sheet-close" onclick="closeAllSheets()">Tutup Panduan</button>
    </div>

    <div class="bottom-sheet" id="confirmSheet">
        <div class="sheet-handle-bar"></div>
        
        <div class="confirm-header">
            <h3>Detail Transaksi</h3>
            <button class="btn-close-x" onclick="closeAllSheets()">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>

        <div class="timer-alert">
            <i class="ri-time-line"></i>
            <div class="timer-text">
                Selesaikan pembayaran dalam waktu <b>00:05:00</b> (5 Menit).
            </div>
        </div>

        <div class="detail-row">
            <span class="label-detail">Game</span>
            <div class="val-detail">
                <span id="conf-provider-name">Mobile Legends</span>
                <img src="" id="conf-provider-logo" alt="Logo">
            </div>
        </div>

        <div class="detail-row">
            <span class="label-detail">Pembelian</span>
            <span class="val-detail" id="conf-product-name">86 Diamonds</span>
        </div>

        <div class="detail-row">
            <span class="label-detail">ID Akun</span>
            <span class="val-detail" id="conf-id-display">-</span>
        </div>

        <div class="dashed-divider"></div>

        <div class="detail-row">
            <span class="label-detail">Status</span>
            <span class="status-badge-pending">Belum Dikonfirmasi</span>
        </div>
        <div class="detail-row">
            <span class="label-detail">ID Transaksi</span>
            <span class="val-detail" id="conf-trx-id">TRX-000000</span>
        </div>
        <div class="detail-row">
            <span class="label-detail">Waktu</span>
            <span class="val-detail" id="conf-time">00:00</span>
        </div>

        <div class="security-bar">
            <div class="sec-left">
                <i class="ri-shield-check-fill sec-icon-shield"></i>
                <span class="sec-text">Transaksi ini aman dengan Xendit</span>
            </div>
            <i class="ri-error-warning-fill sec-icon-warn"></i>
        </div>

        <div class="detail-row">
            <span class="label-detail">Metode Pembayaran</span>
            <div class="val-detail">
                <span id="conf-payment-name">QRIS</span>
                <img src="" id="conf-payment-logo" alt="Pay">
            </div>
        </div>

        <div class="detail-row">
            <span class="label-detail">Total Tagihan</span>
            <span class="val-detail" style="color: var(--accent-orange); font-size: 15px;" id="conf-total">Rp 0</span>
        </div>

        <button class="btn-checkout-sheet" style="font-family: var(--font-body); background: linear-gradient(to bottom, #fad318, #fad318); color: #222; font-weight: 700; border: none; padding: 10px 20px; border-radius: 13px; font-size: 15px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; margin-top: 20px; transition: transform 0.2s;" onclick="continueToPayment()">
            <i class="ri-shield-check-fill"></i> Konfirmasi Pembayaran
        </button>
    </div>

<script>
    // --- 1. DATA MASTER GAME ---
    const gamesConfig = {
        'mlbb': {
            name: 'MOBILE LEGENDS',
            label: 'MLBB',
            publisher: 'Moonton',
            logo: 'https://upload.wikimedia.org/wikipedia/en/thumb/d/d5/Mobile_Legends_Bang_Bang_logo.svg/1200px-Mobile_Legends_Bang_Bang_logo.svg.png',
            color: '#6222cc',
            placeholder: '',
            hasZone: true // Logic untuk Zone ID
        },
        'ff': {
            name: 'FREE FIRE',
            label: 'Free Fire',
            publisher: 'Garena',
            logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/Free_Fire_logo.svg/2560px-Free_Fire_logo.svg.png',
            color: '#ec1c24',
            placeholder: '12345678',
            hasZone: false // Hanya User ID
        },
        'pubgm': {
            name: 'PUBG MOBILE',
            label: 'PUBGM',
            publisher: 'Tencent',
            logo: 'https://upload.wikimedia.org/wikipedia/en/thumb/c/c2/PUBG_Mobile_Logo.png/1200px-PUBG_Mobile_Logo.png',
            color: '#ffc107',
            placeholder: '51234567',
            hasZone: false
        },
        'genshin': {
            name: 'GENSHIN IMPACT',
            label: 'Genshin',
            publisher: 'HoYoverse',
            logo: 'https://upload.wikimedia.org/wikipedia/en/thumb/5/5f/Genshin_Impact_logo.svg/1200px-Genshin_Impact_logo.svg.png',
            color: '#002dbb',
            placeholder: '800123456',
            hasZone: false
        }
    };

    // --- 2. DATA PRODUK DIAMOND ---
    const productsDB = {
        'mlbb': [
            { denom: '86 Diamonds', price: 19000, display: 'Rp 19.000' },
            { denom: '172 Diamonds', price: 38000, display: 'Rp 38.000' },
            { denom: '257 Diamonds', price: 57000, display: 'Rp 57.000' },
            { denom: '706 Diamonds', price: 155000, display: 'Rp 155.000' },
            { denom: '2195 Diamonds', price: 480000, display: 'Rp 480.000' },
            { denom: 'Starlight Member', price: 145000, display: 'Rp 145.000' }
        ],
        'ff': [
            { denom: '70 Diamonds', price: 10000, display: 'Rp 10.000' },
            { denom: '140 Diamonds', price: 19500, display: 'Rp 19.500' },
            { denom: '355 Diamonds', price: 49000, display: 'Rp 49.000' },
            { denom: '720 Diamonds', price: 98000, display: 'Rp 98.000' },
            { denom: '1450 Diamonds', price: 195000, display: 'Rp 195.000' },
            { denom: 'Membership Mingguan', price: 28000, display: 'Rp 28.000' }
        ],
        'pubgm': [
            { denom: '60 UC', price: 14000, display: 'Rp 14.000' },
            { denom: '325 UC', price: 70000, display: 'Rp 70.000' },
            { denom: '660 UC', price: 140000, display: 'Rp 140.000' },
            { denom: '1800 UC', price: 350000, display: 'Rp 350.000' }
        ],
        'genshin': [
            { denom: '60 Genesis', price: 16000, display: 'Rp 16.000' },
            { denom: '300 Genesis', price: 79000, display: 'Rp 79.000' },
            { denom: '980 Genesis', price: 249000, display: 'Rp 249.000' },
            { denom: 'Welkin Moon', price: 79000, display: 'Rp 79.000' }
        ]
    };

    // --- VARIABLES ---
    let currentProductPrice = 0;
    let currentProductName = "";
    let currentFee = 0;
    let currentPaymentMethod = "";
    let currentPaymentType = ""; 
    let currentPaymentLogoSrc = ""; 
    let pendingTransactionData = null;

    function formatRupiah(angka) {
        return "Rp " + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    // --- FUNGSI UTAMA: INIT HALAMAN DINAMIS ---
    function initDynamicPage() {
        const urlParams = new URLSearchParams(window.location.search);
        let currentKey = urlParams.get('game');
        if (!currentKey || !gamesConfig[currentKey]) {
            currentKey = 'mlbb';
        }

        const config = gamesConfig[currentKey];
        const products = productsDB[currentKey] || productsDB['mlbb'];

        // 2. Update Header Utama
        document.getElementById('dynamic-logo').src = config.logo;
        document.getElementById('dynamic-title').innerText = config.name;
        document.getElementById('dynamic-subtitle').innerText = config.publisher;

        // 3. Update Breadcrumb & Input Label
        document.getElementById('dynamic-breadcrumb').innerText = config.label;
        document.getElementById('input-step-title').innerText = `Masukkan ID ${config.name}`;
        document.getElementById('input-userid').placeholder = config.placeholder;
        document.getElementById('summary-id-label').innerText = `ID Akun (${config.label})`;
        document.getElementById('summary-product').innerText = config.name;

        // --- HANDLE ZONE ID LOGIC (TAMBAHAN UTAMA) ---
        const zoneWrapper = document.getElementById('wrapper-zoneid');
        const guideZone = document.getElementById('guide-step-zone');
        const inputZone = document.getElementById('input-zoneid');

        if (config.hasZone) {
            // Jika MLBB (Butuh Zone ID)
            zoneWrapper.classList.remove('hidden');
            guideZone.style.display = 'flex';
            inputZone.value = ''; // Reset
        } else {
            // Jika FF/Other (Tidak butuh Zone ID)
            zoneWrapper.classList.add('hidden');
            guideZone.style.display = 'none';
            inputZone.value = '';
        }
        // -------------------------------------------------

        // 4. Render Tags Navigasi
        const tagsContainer = document.getElementById('provider-tags');
        tagsContainer.innerHTML = ''; 

        Object.keys(gamesConfig).forEach(key => {
            const p = gamesConfig[key];
            const a = document.createElement('a');
            a.href = `?game=${key}`; 
            a.className = 'tag';
            a.innerText = p.label;
            
            if (key === currentKey) {
                a.style.background = config.color;
                a.style.color = (key === 'ff') ? '#000' : '#fff'; 
                a.style.fontWeight = 'bold';
            }
            tagsContainer.appendChild(a);
        });

        // 5. Render Grid Produk
        const gridContainer = document.getElementById('products-container');
        gridContainer.innerHTML = ''; 

        products.forEach(item => {
            const productName = `${config.label} ${item.denom}`;
            const cardHTML = `
                <div class="item-card" onclick="selectProduct(this, ${item.price}, '${productName}')">
                    <div class="item-name">${item.denom}</div>
                    <div class="item-price">${item.display}</div>
                </div>
            `;
            gridContainer.insertAdjacentHTML('beforeend', cardHTML);
        });
    }

    // --- LOGIC TRANSAKSI ---

    // 1. Pilih Produk
    function selectProduct(element, price, name) {
        const useridInput = document.getElementById('input-userid');
        const zoneidInput = document.getElementById('input-zoneid');
        const formCard = document.getElementById('form-identity-card');
        const isMLBB = document.getElementById('wrapper-zoneid').classList.contains('hidden') === false;

        // Validasi ID
        if (useridInput.value.length < 5) {
            formCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
            formCard.classList.add('card-danger');
            useridInput.classList.add('input-danger');
            setTimeout(() => { formCard.classList.remove('card-danger'); useridInput.classList.remove('input-danger'); }, 1000);
            return;
        }

        if (isMLBB && (zoneidInput.value.length < 3 || zoneidInput.value === '')) {
            formCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
            formCard.classList.add('card-danger');
            zoneidInput.classList.add('input-danger');
            setTimeout(() => { formCard.classList.remove('card-danger'); zoneidInput.classList.remove('input-danger'); }, 1000);
            return;
        }

        document.querySelectorAll('.item-card').forEach(item => item.classList.remove('active'));
        element.classList.add('active');

        currentProductPrice = price;
        currentProductName = name;
        
        updatePaymentPrices();
        updateSummary();
    }

    // 2. Pilih Pembayaran
    function selectPayment(element, name, fee, type = '') {
        if (currentProductPrice === 0) {
            alert("Silakan pilih nominal diamond terlebih dahulu.");
            return;
        }

        document.querySelectorAll('.payment-item, .payment-item-qris').forEach(item => item.classList.remove('active'));
        element.classList.add('active');

        currentPaymentMethod = name;
        currentPaymentType = type;
        currentPaymentLogoSrc = element.querySelector('.pay-logo').src;
        currentFee = fee;
        
        updateSummary();
    }

    // 3. Update Harga di List Pembayaran
    function updatePaymentPrices() {
        document.querySelectorAll('.payment-item, .payment-item-qris').forEach(item => {
            const priceElement = item.querySelector('.pay-price');
            const fee = parseInt(priceElement.getAttribute('data-fee'));
            if (currentProductPrice > 0) {
                priceElement.innerText = formatRupiah(currentProductPrice + fee);
                priceElement.style.color = "#333";
            } else {
                priceElement.innerText = "Rp -";
            }
        });
    }

    // 4. Update Summary Bawah
   function updateSummary() {
        if (currentProductPrice > 0) {
            const userIdVal = document.getElementById('input-userid').value;
            const zoneIdVal = document.getElementById('input-zoneid').value;
            
            let displayId = userIdVal;
            if (zoneIdVal) displayId += ` (${zoneIdVal})`;

            document.getElementById('summary-id-val').innerText = displayId;
            document.getElementById('summary-item').innerText = currentProductName || "-";
            document.getElementById('summary-price').innerText = formatRupiah(currentProductPrice);
            document.getElementById('summary-fee').innerText = formatRupiah(currentFee);
            
            const grandTotal = currentProductPrice + currentFee;
            document.getElementById('summary-total').innerText = formatRupiah(grandTotal);
            document.getElementById('total-display').innerText = formatRupiah(grandTotal);
        }
    }

    // --- LOGIC PROSES ORDER & SIMULASI ---
    function processOrder() {
        // 1. Validasi Input
        const useridInput = document.getElementById('input-userid');
        const zoneidInput = document.getElementById('input-zoneid');
        const isMLBB = document.getElementById('wrapper-zoneid').classList.contains('hidden') === false;

        if (useridInput.value.length < 5) {
            alert("User ID tidak valid!");
            useridInput.focus();
            return;
        }
        if (isMLBB && zoneidInput.value.length < 3) {
            alert("Zone ID tidak valid!");
            zoneidInput.focus();
            return;
        }

        if (currentProductPrice === 0) {
            alert("Silakan pilih produk terlebih dahulu!");
            document.getElementById('products-container').scrollIntoView({behavior: 'smooth'});
            return;
        }
        if (currentPaymentMethod === "") {
            alert("Silakan pilih metode pembayaran!");
            document.getElementById('payment-section').scrollIntoView({behavior: 'smooth'});
            return;
        }

        // 2. Generate Data Transaksi
        const grandTotal = currentProductPrice + currentFee;
        const randomTrx = Math.floor(100000 + Math.random() * 900000);
        const now = new Date();
        const timeString = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
        const dateStr = now.getDate() + '/' + (now.getMonth()+1) + '/' + now.getFullYear();

        let idDisplay = useridInput.value;
        if(zoneidInput.value) idDisplay += ` (${zoneidInput.value})`;

        pendingTransactionData = {
            id: randomTrx,
            dateFull: dateStr + ' ' + timeString,
            time: timeString,
            phone: idDisplay,
            product: currentProductName,
            method: currentPaymentMethod,
            total: grandTotal,
            logo: currentPaymentLogoSrc,
            va: "8800 " + Math.floor(1000000000 + Math.random() * 9000000000)
        };

        // 3. Isi Data ke Bottom Sheet Konfirmasi
        const providerLogoMain = document.getElementById('dynamic-logo').src;
        const providerNameMain = document.getElementById('dynamic-title').innerText;

        document.getElementById('conf-provider-name').innerText = providerNameMain;
        document.getElementById('conf-provider-logo').src = providerLogoMain;
        
        document.getElementById('conf-product-name').innerText = currentProductName;
        document.getElementById('conf-id-display').innerText = idDisplay;
        document.getElementById('conf-trx-id').innerText = "TRX-" + randomTrx;
        document.getElementById('conf-time').innerText = dateStr + " " + timeString;
        
        document.getElementById('conf-payment-name').innerText = currentPaymentMethod;
        document.getElementById('conf-payment-logo').src = currentPaymentLogoSrc;
        document.getElementById('conf-total').innerText = formatRupiah(grandTotal);

        // 4. Buka Bottom Sheet
        document.getElementById('sheetOverlay').classList.add('active');
        document.getElementById('confirmSheet').classList.add('active');
    }

    function closeAllSheets() {
        document.getElementById('sheetOverlay').classList.remove('active');
        document.getElementById('guideSheet').classList.remove('active');
        document.getElementById('tutorialSheet').classList.remove('active');
        document.getElementById('confirmSheet').classList.remove('active');
    }

    function openGuide() { document.getElementById('sheetOverlay').classList.add('active'); document.getElementById('guideSheet').classList.add('active'); }
    function openTutorial() { document.getElementById('sheetOverlay').classList.add('active'); document.getElementById('tutorialSheet').classList.add('active'); }

    // --- FUNGSI LANJUT KE PEMBAYARAN ---
    function continueToPayment() {
        closeAllSheets();
        const data = pendingTransactionData;

        document.getElementById('invoice-view').style.display = 'none';
        document.getElementById('sim-view').style.display = 'block';

        // Isi Data Simulasi
        document.getElementById('sim-bank-logo').src = data.logo;
        document.getElementById('sim-payment-name').innerText = data.method;
        document.getElementById('sim-total').innerText = formatRupiah(data.total);

        const qrContainer = document.getElementById('sim-qr-container');
        const vaContainer = document.getElementById('sim-va-container');
        
        if (currentPaymentType === 'qris') {
            qrContainer.classList.add('active');
            vaContainer.classList.add('hidden');
            const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=GAMESQUAD-${data.id}`;
            document.getElementById('sim-qr-image').src = qrApiUrl;
        } else {
            qrContainer.classList.remove('active');
            vaContainer.classList.remove('hidden');
            document.getElementById('sim-va-number').innerText = data.va;
            document.getElementById('sim-bank-name').innerText = data.method;
        }

        document.getElementById('modal-overlay').classList.add('active');

        // Simulasi Sukses Otomatis (3 Detik)
        setTimeout(() => {
            showSuccessInvoice(data);
            saveToLocalStorage(data);
        }, 3000);
    }

    // --- INVOICE SUKSES ---
    function showSuccessInvoice(data) {
        document.getElementById('sim-view').style.display = 'none';
        document.getElementById('invoice-view').style.display = 'flex';
        
        document.getElementById('inv-trx-id').innerText = data.id;
        document.getElementById('inv-phone').innerText = data.phone;
        document.getElementById('inv-product').innerText = data.product;
        document.getElementById('inv-method').innerText = data.method;
        document.getElementById('inv-total').innerText = formatRupiah(data.total);
        document.getElementById('inv-time').innerText = data.time;
    }

    // --- HISTORY ---
    function saveToLocalStorage(trxData) {
        const history = JSON.parse(localStorage.getItem('topupHistoryFull')) || [];
        history.unshift(trxData);
        localStorage.setItem('topupHistoryFull', JSON.stringify(history));
        loadHistory();
    }

    function loadHistory() {
        const history = JSON.parse(localStorage.getItem('topupHistoryFull')) || [];
        const container = document.getElementById('history-list-container');
        
        if (history.length === 0) {
            container.innerHTML = '<div class="empty-history">Belum ada transaksi.</div>';
            return;
        }

        container.innerHTML = '';
        history.forEach(trx => {
            container.innerHTML += `
            <div class="history-item" onclick="openHistoryDetail(${trx.id})">
                <div class="h-left">
                    <span class="h-date">${trx.dateFull}</span>
                    <span class="h-product">${trx.product}</span>
                    <span style="font-size:10px; color:#a0aec0;">${trx.phone}</span>
                </div>
                <div class="h-right">
                    <div class="h-status">Sukses</div>
                    <div class="h-price">${formatRupiah(trx.total)}</div>
                </div>
            </div>`;
        });
    }

    function openHistoryDetail(trxId) {
        const history = JSON.parse(localStorage.getItem('topupHistoryFull')) || [];
        const trx = history.find(item => item.id == trxId);
        if (trx) {
            showSuccessInvoice(trx);
            document.getElementById('modal-overlay').classList.add('active');
        } else {
            alert("Data tidak ditemukan.");
        }
    }

    function closeModal() {
        document.getElementById('modal-overlay').classList.remove('active');
        document.querySelectorAll('.item-card, .payment-item, .payment-item-qris').forEach(e => e.classList.remove('active'));
        currentProductPrice = 0;
        updateSummary();
    }

    function checkPaymentSim() { alert("Pembayaran sedang dicek..."); }
    function downloadInvoice() { window.print(); }

    // --- INIT ---
    document.addEventListener('DOMContentLoaded', () => {
        initDynamicPage();
        loadHistory();
        
        document.getElementById('input-userid').addEventListener('input', function() {
            this.classList.remove('input-danger');
            document.getElementById('form-identity-card').classList.remove('card-danger');
            updateSummary();
        });

        document.getElementById('input-zoneid').addEventListener('input', function() {
            this.classList.remove('input-danger');
            document.getElementById('form-identity-card').classList.remove('card-danger');
            updateSummary();
        });
    });
</script>
</body>
</html>
